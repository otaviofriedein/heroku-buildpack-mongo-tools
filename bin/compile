#!/bin/sh
BUILD_DIR=$1
CACHE_DIR=$2

MONGO_TOOLS_VERSION=100.9.4
ARCH=x86_64
OS=ubuntu2204

FILE=mongodb-database-tools-${OS}-${ARCH}-${MONGO_TOOLS_VERSION}
URL=https://fastdl.mongodb.org/tools/db/${FILE}.tgz

echo ">> Baixando MongoDB Database Tools $MONGO_TOOLS_VERSION..."

curl -L -o /tmp/mongo-tools.tgz "$URL"
if [ $? -ne 0 ]; then
  echo "ERRO ao baixar $URL"
  exit 1
fi

echo ">> Extraindo ferramentas..."
mkdir -p $BUILD_DIR/.mongo-tools
tar -xzf /tmp/mongo-tools.tgz -C $BUILD_DIR/.mongo-tools --strip-components=1

echo ">> Adicionando ao PATH..."
mkdir -p $BUILD_DIR/.profile.d
echo 'export PATH="$HOME/.mongo-tools/bin:$PATH"' > $BUILD_DIR/.profile.d/mongo-tools.sh
